


models/gemma3/1/model.py(33): execute\n"
W0727 11:15:42.931000 1443 torch/_dynamo/convert_frame.py:1067] [0/2327] torch._dynamo hit config.recompile_limit (8)
W0727 11:15:42.931000 1443 torch/_dynamo/convert_frame.py:1067] [0/2327]    function: 'wrapper' (/usr/local/lib/python3.12/dist-packages/transformers/utils/generic.py:927)
W0727 11:15:42.931000 1443 torch/_dynamo/convert_frame.py:1067] [0/2327]    last reason: 0/7: ___check_obj_id(kwargs['past_key_values'].key_cache[0], 126824692162448)
W0727 11:15:42.931000 1443 torch/_dynamo/convert_frame.py:1067] [0/2327] To log all recompilation reasons, use TORCH_LOGS="recompiles".
W0727 11:15:42.931000 1443 torch/_dynamo/convert_frame.py:1067] [0/2327] To diagnose recompilation issues, see https://pytorch.org/docs/main/torch.compiler_troubleshooting.html
E0727 11:15:42.933588 1 pb_stub.cc:736] "Failed to process the request(s) for model 'gemma3_0_0', message: FailOnRecompileLimitHit: recompile_limit reached with one_graph=True or error_on_graph_break=True. Excessive recompilations can degrade performance due to the compilation overhead of each recompilation. To monitor recompilations, enable TORCH_LOGS=recompiles. If recompilations are expected, consider increasing torch._dynamo.config.cache_size_limit to an appropriate value.\n\nAt:\n  /usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py(1084): _compile\n  /usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py(652): __call__\n  /usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py(1364): __call__\n  /usr/local/lib/python3.12/dist-packages/torch/_dynamo/convert_frame.py(1586): __call__\n  /usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py(1784): _call_impl\n  /usr/local/lib/python3.12/dist-packages/torch/nn/modules/module.py(1773): _wrapped_call_impl\n  /usr/local/lib/python3.12/dist-packages/torch/_dynamo/eval_frame.py(803): compile_wrapper\n  /usr/local/lib/python3.12/dist-packages/transformers/generation/utils.py(3609): _sample\n  /usr/local/lib/python3.12/dist-packages/transformers/generation/utils.py(2625): generate\n  /usr/local/lib/python3.12/dist-packages/torch/utils/_contextlib.py(120): decorate_context\n  /models/gemma3/1/model.py(33): execute\n"


Šta znači poruka?
TorchDynamo pokušava dinamički "kompajlirati" (optimizirati) graf vašeg modela tokom izvršavanja.
Svaki "graph break" (prepreka koja sprečava potpuni tracing modela zbog raznih dinamika ili nesigurnih operacija) može prouzrokovati novu kompilaciju.
recompile_limit reached znači da je broj dozvoljenih rekompilacija prešao zadatu vrednost (standardno ih može biti 20).
Svaka rekompilacija troši vreme i pamćenje, i to nije poželjno, zato PyTorch baca ovu grešku.
Ako jedan model veoma često menja strukturu grafa (npr. ima puno if grana, petlji sa različitim ponašanjem itd...), Dynamo mora ponovo da ga "kompajlira" svaki put kad naiđe na novu situaciju.


LOCUST


--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------
POST     gemma3/infer                                                                    2397 2397(100.00%) |   4363      11   12612   5500 |    1.80        1.80
POST     meta-llama/infer                                                                 148   45(30.41%) |  80020      11  137291 129000 |    0.11        0.03
POST     mistral/infer                                                                    148   55(37.16%) |  73642      11  150862 117000 |    0.11        0.04
--------|----------------------------------------------------------------------------|-------|-------------|-------|-------|-------|-------|--------|-----------
         Aggregated                                                                      2693 2497(92.72%) |  12329      11  150862   5700 |    2.02        1.87

Response time percentiles (approximated)
Type     Name                                                                                  50%    66%    75%    80%    90%    95%    98%    99%  99.9% 99.99%   100% # reqs
--------|--------------------------------------------------------------------------------|--------|------|------|------|------|------|------|------|------|------|------|------
POST     gemma3/infer                                                                         5500   6500   7000   7200   8100   9000  10000  11000  12000  13000  13000   2397
POST     meta-llama/infer                                                                   129000 131000 132000 132000 133000 135000 137000 137000 137000 137000 137000    148
POST     mistral/infer                                                                      121000 126000 129000 131000 134000 139000 150000 150000 151000 151000 151000    148
--------|--------------------------------------------------------------------------------|--------|------|------|------|------|------|------|------|------|------|------|------
         Aggregated                                                                           5700   6700   7200   7700   9600 125000 132000 134000 150000 151000 151000   2693

Error report
# occurrences      Error                                                                                               
------------------|---------------------------------------------------------------------------------------------------------------------------------------------
45                 POST meta-llama/infer: HTTPError('400 Client Error: Bad Request for url: meta-llama/infer')         
55                 POST mistral/infer: HTTPError('400 Client Error: Bad Request for url: mistral/infer')               
824                POST gemma3/infer: HTTPError('400 Client Error: Bad Request for url: gemma3/infer')                 
1573               POST gemma3/infer: HTTPError('500 Server Error: Internal Server Error for url: gemma3/infer')       
------------------|---------------------------------------------------------------------------------------------------------------------------------------------
